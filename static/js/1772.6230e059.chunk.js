"use strict";(self.webpackChunkjio_design_system=self.webpackChunkjio_design_system||[]).push([[1772],{6874:(e,l,a)=>{a.d(l,{S:()=>r});var n=a(89379),s=a(80045),t=(a(9950),a(13852)),i=a(41676),d=a(44414);const c=["checked","onChange","label","labelPlacement","disabled","id","name"];function r(e){let{checked:l,onChange:a,label:r,labelPlacement:o="end",disabled:u=!1,id:h,name:m}=e,x=(0,s.A)(e,c);const p=(0,d.jsx)(t.A,(0,n.A)({id:h,name:m,checked:l,onChange:a,disabled:u,inputProps:{"aria-label":r?void 0:x["aria-label"]||"Switch"}},x));return r?(0,d.jsx)(i.A,{control:p,label:r,labelPlacement:o,disabled:u,htmlFor:h}):p}},41772:(e,l,a)=>{a.r(l),a.d(l,{default:()=>A});var n=a(89379),s=a(9950),t=a(27321),i=a(32284),d=a(56141),c=a(94837),r=a(91651),o=a(6503),u=a(11739),h=a(67479),m=a(17859),x=a(6874),p=a(32899),b=a(33176),f=a(42095),v=a(44414);const j=[{value:"admin",label:"\uad00\ub9ac\uc790"},{value:"user",label:"\uc77c\ubc18 \uc0ac\uc6a9\uc790"}],w=[{value:"all",label:"\uc804\uccb4"},{value:"allowed",label:"\ud5c8\uc6a9"},{value:"denied",label:"\uac70\ubd80"}],g=function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const a=[];return e.forEach(e=>{e.menu&&a.push({id:e.id,name:e.menu.text,path:e.path,depth:l}),e.children&&a.push(...g(e.children,l+1))}),a},C=g(f.G);function A(){var e;const[l,a]=(0,s.useState)("admin"),[f,g]=(0,s.useState)([]),[A,_]=(0,s.useState)(C),[S,k]=(0,s.useState)(!1),[y,z]=(0,s.useState)(null),[P,F]=(0,s.useState)(null),[N,U]=(0,s.useState)(!1),[D,L]=(0,s.useState)(""),[G,I]=(0,s.useState)("all"),q=(0,s.useCallback)(async()=>{k(!0),z(null);const{permissions:e,error:a}=await b.UU.getPermissionsByRole(l);a?z(a):g(e),k(!1),U(!1)},[l]);(0,s.useEffect)(()=>{q()},[q]);const E=e=>{const l=f.find(l=>l.menu_id===e);return!l||l.can_access},H=[{field:"id",headerName:"\uba54\ub274 ID",width:180},{field:"name",headerName:"\uba54\ub274\uba85",flex:1,minWidth:150},{field:"path",headerName:"\uacbd\ub85c",width:200},{field:"can_access",headerName:"\uc811\uadfc \uad8c\ud55c",width:100,align:"center",headerAlign:"center",renderCell:e=>{const a=E(e.row.id);return(0,v.jsx)(x.S,{checked:a,onChange:()=>((e,a)=>{const s=f.findIndex(l=>l.menu_id===e);if(s>=0){const e=[...f];e[s]=(0,n.A)((0,n.A)({},e[s]),{},{can_access:!a}),g(e)}else{const n={id:"",role:l,menu_id:e,can_access:!a,created_at:"",updated_at:""};g([...f,n])}U(!0)})(e.row.id,a),size:"small"})}}],R=A.map(e=>({id:e.id,name:"\u3000".repeat(e.depth)+e.name,path:e.path,depth:e.depth}));return(0,v.jsxs)(t.A,{sx:{display:"flex",flexDirection:"column",flex:1,minHeight:0,p:3},children:[(0,v.jsx)(u.od,{title:"\uba54\ub274 \uad8c\ud55c \uad00\ub9ac",children:(0,v.jsx)(p.U9,{onClick:()=>{L(""),I("all"),_(C)}})}),y&&(0,v.jsx)(i.A,{severity:"error",sx:{mb:2},onClose:()=>z(null),children:y}),P&&(0,v.jsx)(i.A,{severity:"success",sx:{mb:2},onClose:()=>F(null),children:P}),(0,v.jsxs)(u.q,{children:[(0,v.jsx)(h.z,{label:"\uc5ed\ud560",htmlFor:"role-select",children:(0,v.jsx)(d.A,{id:"role-select",value:l,onChange:e=>{a(e.target.value)},sx:{width:"150px"},children:j.map(e=>(0,v.jsx)(c.A,{value:e.value,children:e.label},e.value))})}),(0,v.jsx)(h.z,{label:"\uba54\ub274\uba85",htmlFor:"menu-name-search",children:(0,v.jsx)(r.A,{id:"menu-name-search",value:D,onChange:e=>L(e.target.value),sx:{width:"200px"},placeholder:"\uba54\ub274\uba85 \ub610\ub294 ID"})}),(0,v.jsx)(h.z,{label:"\uc811\uadfc \uad8c\ud55c",htmlFor:"access-search",children:(0,v.jsx)(d.A,{id:"access-search",value:G,onChange:e=>I(e.target.value),sx:{width:"150px"},children:w.map(e=>(0,v.jsx)(c.A,{value:e.value,children:e.label},e.value))})}),(0,v.jsx)(p.Y9,{onClick:()=>{let e=[...C];D&&(e=e.filter(e=>e.name.toLowerCase().includes(D.toLowerCase())||e.id.toLowerCase().includes(D.toLowerCase()))),"all"!==G&&(e=e.filter(e=>{const l=E(e.id);return"allowed"===G?l:!l})),_(e)}})]}),(0,v.jsxs)(t.A,{sx:{flexGrow:1,display:"flex",flexDirection:"column",minHeight:0},children:[(0,v.jsxs)(u.aq,{title:"".concat(null===(e=j.find(e=>e.value===l))||void 0===e?void 0:e.label," \uba54\ub274 \uad8c\ud55c (").concat(R.length,"\uac1c)"),children:[S&&(0,v.jsx)(o.A,{size:20}),(0,v.jsx)(p.yY,{onClick:async()=>{k(!0),z(null),F(null);const e=f.map(e=>({role:l,menu_id:e.menu_id,can_access:e.can_access})),{success:a,error:n}=await b.UU.updatePermissions(e);n?z(n):a&&(F("\uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),U(!1),setTimeout(()=>F(null),3e3)),k(!1)},disabled:!N||S})]}),(0,v.jsx)(m.A,{rows:R,columns:H,sx:{flexGrow:1},showRowNumber:!0,hideFooter:!0,loading:S,paginationModel:{page:0,pageSize:100}})]})]})}}}]);